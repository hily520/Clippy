### ClippyMVP 架构设计报告

#### 项目背景与目标
Clippy（个人知识库 AI 代理，PKB-AI）旨在通过去中心化智能体生态系统，实现人类意识的数字化延伸，并以人形机器人为终端构建全球机器人国际商业企业（RIBM）。受 "认知坎陷" 理论启发，Clippy 通过主动哈希交互网络（AHIN）和可信 AI 技术，打造类似 Apple iOS App Store 的 AI 智能体商店。MVP 目标是构建一个桌面助手，允许用户上传多模态文件，进行 AI 处理和知识库存储，同时提供 Token 经济激励。

#### MVP 架构概述
MVP 由四个主要部分组成：
1. **前端（Electron 桌面应用）**
2. **本地后端（Electron 主进程）**
3. **服务器后端（公共领域管理和 Token 奖励）**
4. **智能合约（BNB Smart Chain 测试链上的 BEP-20 代币）**

### 详细设计

#### **前端设计**
**技术选择：**
- 采用 Electron 框架（版本 22 或最新稳定版）
- UI 使用 React 或 Angular，确保用户友好性
- 兼容钱包（如 Metamask、BITGET、BINANCE Wallet）集成 DID 认证

**主要 UI 组件：**
- **聊天界面：** 输入框、消息显示区域，支持用户提问和 AI 或专家回答。
- **文件上传对话框：** 支持文本、图片、视频等多模态文件上传。
- **Token 余额显示：** 定期从服务器获取并显示用户 Token 余额。

**核心功能：**
- **文件上传**：用户选择文件后，主进程调用 AI API 进行处理。
- **聊天交互**：基于本地知识库生成回答，若 AI 回答不足，则推送至服务器。
- **Token 查看**：通过服务器 API 获取用户 Token 余额并显示。

#### **本地后端设计（Electron 主进程）**
**技术选择：**
- Node.js 作为主进程运行环境
- SQLite 作为本地加密数据库
- Axios 处理 AI API 请求

**文件处理：**
- **文本文件**：发送至 Deepseek API 进行总结。
- **图片文件**：发送至 Google Cloud Vision 进行分析。
- **视频文件**：使用 Google Cloud Video Intelligence 提取内容。

**数据存储：**
- 采用 MySQL 存储 AI 处理后的知识总结，每条记录哈希链接前一记录，模拟个人隐私链。
- 数据库加密确保隐私安全。

**聊天交互：**
- 从本地数据库检索知识，结合 AI API 生成回答。
- 若 AI 回答不足，通过 RESTful API 发送至公共领域服务器。

**通信安全：**
- 所有 API 请求使用 HTTPS 进行加密传输。

#### **服务器后端设计**
**技术选择：**
- Java + Spring 作为 Web 后端框架
- MySQL 存储公共领域问题和答案
- Ethers.js 交互以太坊测试链

**公共领域管理：**
- **API 端点**：接收用户提交的问题，存储至 MySQL。
- **答案提交**：用户或专家可提交回答，AI 评估答案质量。
- **精选机制**：AI 结合人工筛选最佳答案。

**Token 经济模型：**
- 选择最佳答案后，服务器调用 Ethers.js，向贡献者转移 1 ClippyToken 奖励。
- Token 由服务器持有的以太坊钱包进行分发。

#### **智能合约设计**
后期将采用 Quorum 隐私链，数据将存储在 IPFS

**平台与功能：**
- 部署在 BNB Smart Chain 测试链，采用 BEP-20 标准。
- 主要功能包括：
  - **addQuestion**（添加精选问题）
  - **addAnswer**（添加精选答案）
  - **claimToken**（领取代币）
  - **addToBlacklist**（加入黑名单）

**Token 经济模型：**
- 初始 Token 设定为 1 ClippyToken 奖励。
- Token 可用于访问高级 AI 服务、交换知识资产。
- 未来版本支持 Robot NFT 交易。

### 未来发展方向
- **AI 强化**：提升 NLP 处理能力，增加多模态 AI 理解。
- **区块链升级**：向 Layer 2 迁移，提高交易效率和降低成本。
- **扩展市场**：集成更多专家学者资源，提升公域问答质量。
- **人形机器人集成**：将 AI 代理与硬件结合，实现机器人经济体。

---

本架构设计确保 ClippyMVP 在用户数据隐私、去中心化知识存储和 Token 经济激励方面具备可行性，为未来全链路 AI 代理生态奠定基础。
